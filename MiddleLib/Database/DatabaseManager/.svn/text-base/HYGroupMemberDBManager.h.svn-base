//
//  HYGroupMemberDBManager.h
//  iRCS
//
//  Created by 王斌 on 15/8/31.
//  Copyright (c) 2015年 frank weng. All rights reserved.
//

#import <Foundation/Foundation.h>
#import "GroupMemberDBModel.h"
#import "HYDatabaseHelper.h"
#import "HYFMDatabase.h"
#import "HYFMDatabaseQueue.h"
#import "RCSIMGroupManager.h"

@interface HYGroupMemberDBManager : NSObject

// 用于数据操作的管理队列
@property (nonatomic, strong) HYFMDatabaseQueue *databaseQueue;
// 用于获取数据的数据库
@property (nonatomic, strong) HYFMDatabase *database;

- (void)setup;
+ (HYGroupMemberDBManager *)defaultManager;

#pragma mark 增

/**
 *  使用默认参数创建数据表
 *
 *  @return 是否成功
 */
- (BOOL)createTable;

/**
 *  添加一条群成员记录
 *
 *  @param groupMemberModel 群成员数据
 *
 *  @return 是否成功
 */
- (BOOL)addGroupMemberInDBWithModel:(GroupMemberDBModel *)groupMemberModel;

/**
 *  插入群成员信息
 *
 *  @param array UserModel 群成员数组
 */
- (BOOL)addGroupMembersInDBWithUserModelArray:(NSArray *)array  GroupID:(NSString *)groupID;

/**
 *  插入群成员信息
 *
 */
- (void)addGroupMembersInDBWithGroupMemberDBModelArray:(NSArray *)array GroupID:(NSString *)groupID;


#pragma mark 查
/**
 *  获取群聊中所有成员的详细信息
 *
 *  @param groupID 群聊的ID，群聊表中的主键值
 *
 *  @return 成员详情列表
 */
-(NSMutableArray *)getGroupMemberDatailInDBWithGroupID:(NSString *)groupID;

/**
 *  获取群成员数量
 *
 *  @param groupID 群聊的ID，群聊表中的主键值
 *
 *  @return 群成员数量
 */
-(int)getGroupMemberCountInDBWithGroupID:(NSString *)groupID;

/**
 *  用户是否存在
 *
 *  @param userID 用户帐号
 *
 *  @return 是否存在
 */
- (BOOL)groupMemberIsExistWithUserID:(NSString *)userID GroupID:(NSString *)groupID;

/**
 *  取成员
 *
 *  @param userID 用户帐号
 *
 *  @return 是否存在
 */
- (GroupMemberDBModel *)getGroupMemberWithUserID:(NSString *)userID GroupID:(NSString *)groupID;


#pragma mark 改
/**
 *  更新单个群聊成员的某个属性
 *
 *  @param member 群成员数据
 *
 *  @return 是否成功
 */
-(BOOL)updateGroupMemberInDBWithModel:(GroupMemberDBModel*)member;

/**
 *  更新某群的所有群成员(先删光，重新添加)
 *
 *  @param groupID 群号
 *
 *  @return 是否成功
 */
- (void)updateGroupMemberInDBWithArray:(NSArray *)userModelArry GroupID:(NSString *)groupID;

/**
 *  更新单个群聊成员昵称
 *
 *  @param nickName 新的昵称
 *  @param userID   用户ID
 *
 *  @return 是否成功
 */
- (BOOL)updateGroupMemberNickNameInDBWithNewName:(NSString *)nickName UserID:(NSString *)userID GroupID:(NSString *)groupID;

/**
 *  设置群主，其余设为群成员
 *
 *  @param groupID
 */
- (void)updateGroupMasterWithGroupID:(NSString *)groupID Master:(NSString *)groupMaster;

#pragma mark 删
/**
 *  删除指定群成员
 *
 *  @param groupID 群组ID
 *  @param userID  用户ID
 *
 *  @return 是否成功
 */
- (BOOL)deleteGroupMemberInDBWithGroupID:(NSString *)groupID UserID:(NSString *)userID;

/**
 *  删除所有群成员
 *
 *  @param groupID 群号
 *
 *  @return 是否删除成功
 */
- (BOOL)deleteGroupMembersInDBWithGroupID:(NSString *)groupID;


@end
